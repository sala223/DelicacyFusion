<?xml version="1.0" encoding="UTF-8"?>
<project name="delicacy-fusion" default="package">
	<import file="build-env.xml" />
	<property name="modules.dir" value="../modules" />
	<property name="release.directory" value="../release" />
	<target name="package">
		<var name="module.name" value="core" />
		<echo message="Run build for module ${module.name}" />
		<ant antfile="build.xml" target="package" dir="${modules.dir}/${module.name}" inheritall="false" inheritrefs="false" useNativeBasedir="true" />
		<copy todir="${release.directory}/${build.version}/${ant.project.name}.ear">
			<fileset dir="${modules.dir}/${module.name}/bin" includes="*.jar" />
		</copy>
		<var name="module.name" value="blob-store" />
		<echo message="Run build for module ${module.name}" />
		<ant antfile="build.xml" target="package" dir="${modules.dir}/${module.name}" inheritall="false" inheritrefs="false" useNativeBasedir="true" />
		<copy todir="${release.directory}/${build.version}/${ant.project.name}.ear">
			<fileset dir="${modules.dir}/${module.name}/bin" includes="*.jar" />
		</copy>
		<var name="module.name" value="master-data" />
		<echo message="Run build for module ${module.name}" />
		<ant antfile="build.xml" target="package" dir="${modules.dir}/${module.name}" inheritall="false" inheritrefs="false" useNativeBasedir="true" />
		<copy todir="${release.directory}/${build.version}/${ant.project.name}.ear">
			<fileset dir="${modules.dir}/${module.name}/bin" includes="*.jar" />
		</copy>
		<var name="module.name" value="order" />
		<echo message="Run build for module ${module.name}" />
		<ant antfile="build.xml" target="package" dir="${modules.dir}/${module.name}" inheritall="false" inheritrefs="false" useNativeBasedir="true" />
		<copy todir="${release.directory}/${build.version}/${ant.project.name}.ear">
			<fileset dir="${modules.dir}/${module.name}/bin" includes="*.jar" />
		</copy>
		<var name="module.name" value="http-master-data" />
		<echo message="Run build for module ${module.name}" />
		<ant antfile="build.xml" target="package" dir="${modules.dir}/${module.name}" inheritall="false" inheritrefs="false" useNativeBasedir="true" />
		<copy todir="${release.directory}/${build.version}/${ant.project.name}.ear">
			<fileset dir="${modules.dir}/${module.name}/bin" includes="*.war" />
		</copy>
		<copy flatten="true" todir="${release.directory}/${build.version}/${ant.project.name}.ear/lib">
			<fileset dir="./third-lib" includes="**/*.jar" excludes="junit*.jar,harncrest*.jar" />
		</copy>
	</target>
</project>

